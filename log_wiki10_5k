start label sorting...
matrix transpose done...
30938 14146
label sorting done...
start training using labels from 0 to 15469
do matrix transpose...
ready to train ....
tree 0 training started
tree 0 training started
tree 1 training started
tree 0 training started
tree 1 training started
tree 2 training started
node 0
node 0
node 0
node 0
split internal node

split internal node

split internal node
time spent on kmeans: 71.6341 secs
time spent on kmeans: 83.8254 secs
n_effective_partitions=96
train leaf node 1 with 9 labels
train leaf node 2 with 39 labels
train leaf node 3 with 28 labels
train leaf node 4 with 39 labels
train leaf node 5 with 33 labels
train leaf node 6 with 18 labels
train leaf node 7 with 74 labels
train leaf node 8 with 26 labels
train leaf node 9 with 51 labels
train leaf node 10 with 83 labels
train leaf node 11 with 88 labels
train leaf node 12 with 26 labels
train leaf node 13 with 124 labels
train leaf node 14 with 83 labels
train leaf node 15 with 147 labels
train leaf node 16 with 79 labels
train leaf node 17 with 54 labels
train leaf node 18 with 81 labels
train leaf node 19 with 109 labels
train leaf node 20 with 144 labels
train leaf node 21 with 99 labels
train leaf node 22 with 204 labels
train leaf node 23 with 85 labels
train leaf node 24 with 290 labels
train leaf node 25 with 143 labels
train leaf node 26 with 301 labels
n_effective_partitions=94
train leaf node 1 with 58 labels
train leaf node 2 with 32 labels
train leaf node 3 with 11 labels
train leaf node 4 with 27 labels
train leaf node 5 with 58 labels
train leaf node 6 with 51 labels
train leaf node 7 with 111 labels
train leaf node 8 with 47 labels
train leaf node 9 with 92 labels
train leaf node 10 with 97 labels
train leaf node 11 with 16 labels
train leaf node 12 with 86 labels
train leaf node 13 with 82 labels
train leaf node 14 with 57 labels
train leaf node 15 with 83 labels
train leaf node 16 with 40 labels
train leaf node 17 with 93 labels
train leaf node 18 with 161 labels
train leaf node 19 with 256 labels
train leaf node 27 with 239 labels
train leaf node 28 with 50 labels
train leaf node 29 with 74 labels
train leaf node 30 with 98 labels
train leaf node 31 with 342 labels
train leaf node 20 with 56 labels
train leaf node 21 with 36 labels
train leaf node 22 with 35 labels
train leaf node 23 with 36 labels
train leaf node 24 with 149 labels
train leaf node 25 with 113 labels
train leaf node 26 with 133 labels
train leaf node 27 with 90 labels
train leaf node 28 with 122 labels
train leaf node 29 with 100 labels
train leaf node 30 with 64 labels
train leaf node 31 with 176 labels
train leaf node 32 with 179 labels
train leaf node 33 with 402 labels
train leaf node 32 with 174 labels
time spent on kmeans: 122.739 secs
train leaf node 33 with 179 labels
train leaf node 34 with 139 labels
train leaf node 34 with 90 labels
train leaf node 35 with 371 labels
train leaf node 35 with 116 labels
train leaf node 36 with 134 labels
train leaf node 37 with 250 labels
train leaf node 38 with 72 labels
train leaf node 39 with 188 labels
train leaf node 36 with 173 labels
train leaf node 40 with 273 labels
train leaf node 37 with 295 labels
train leaf node 41 with 37 labels
train leaf node 42 with 144 labels
train leaf node 43 with 68 labels
train leaf node 44 with 191 labels
train leaf node 38 with 110 labels
train leaf node 39 with 45 labels
train leaf node 40 with 64 labels
train leaf node 45 with 215 labels
train leaf node 41 with 281 labels
train leaf node 46 with 139 labels
train leaf node 47 with 105 labels
train leaf node 48 with 131 labels
train leaf node 49 with 76 labels
train leaf node 50 with 58 labels
train leaf node 51 with 173 labels
train leaf node 42 with 116 labels
train leaf node 52 with 162 labels
train leaf node 43 with 401 labels
train leaf node 53 with 63 labels
train leaf node 54 with 174 labels
train leaf node 55 with 48 labels
train leaf node 56 with 80 labels
train leaf node 57 with 112 labels
train leaf node 58 with 85 labels
train leaf node 59 with 29 labels
train leaf node 60 with 60 labels
train leaf node 61 with 67 labels
train leaf node 62 with 211 labels
train leaf node 63 with 139 labels
train leaf node 64 with 94 labels
train leaf node 65 with 167 labels
train leaf node 66 with 71 labels
train leaf node 67 with 382 labels
train leaf node 44 with 30 labels
train leaf node 45 with 83 labels
train leaf node 46 with 128 labels
train leaf node 47 with 340 labels
train leaf node 68 with 396 labels
train leaf node 48 with 211 labels
n_effective_partitions=97
train leaf node 1 with 36 labels
train leaf node 2 with 51 labels
train leaf node 3 with 64 labels
train leaf node 4 with 24 labels
train leaf node 5 with 42 labels
train leaf node 6 with 28 labels
train leaf node 7 with 79 labels
train leaf node 8 with 73 labels
train leaf node 9 with 86 labels
train leaf node 10 with 24 labels
train leaf node 11 with 63 labels
train leaf node 12 with 71 labels
train leaf node 13 with 25 labels
train leaf node 14 with 115 labels
train leaf node 15 with 68 labels
train leaf node 49 with 28 labels
train leaf node 50 with 261 labels
train leaf node 16 with 77 labels
train leaf node 17 with 23 labels
train leaf node 18 with 96 labels
train leaf node 19 with 99 labels
train leaf node 20 with 37 labels
train leaf node 21 with 89 labels
train leaf node 22 with 141 labels
train leaf node 51 with 43 labels
train leaf node 52 with 98 labels
train leaf node 23 with 107 labels
train leaf node 24 with 36 labels
train leaf node 53 with 50 labels
train leaf node 25 with 70 labels
train leaf node 54 with 231 labels
train leaf node 26 with 51 labels
train leaf node 27 with 89 labels
train leaf node 28 with 83 labels
train leaf node 29 with 27 labels
train leaf node 30 with 96 labels
train leaf node 31 with 86 labels
train leaf node 32 with 229 labels
train leaf node 69 with 285 labels
train leaf node 33 with 58 labels
train leaf node 34 with 139 labels
train leaf node 35 with 75 labels
train leaf node 55 with 32 labels
train leaf node 56 with 92 labels
train leaf node 36 with 63 labels
train leaf node 37 with 45 labels
train leaf node 38 with 83 labels
train leaf node 57 with 88 labels
train leaf node 58 with 191 labels
train leaf node 70 with 280 labels
train leaf node 39 with 298 labels
train leaf node 59 with 83 labels
train leaf node 60 with 70 labels
train leaf node 61 with 286 labels
train leaf node 40 with 129 labels
train leaf node 71 with 64 labels
train leaf node 72 with 101 labels
train leaf node 41 with 46 labels
train leaf node 73 with 34 labels
train leaf node 74 with 470 labels
train leaf node 42 with 361 labels
train leaf node 62 with 157 labels
train leaf node 63 with 118 labels
train leaf node 64 with 199 labels
train leaf node 65 with 356 labels
train leaf node 75 with 168 labels
train leaf node 76 with 247 labels
train leaf node 77 with 108 labels
train leaf node 78 with 304 labels
train leaf node 43 with 186 labels
train leaf node 44 with 114 labels
train leaf node 79 with 104 labels
train leaf node 45 with 156 labels
train leaf node 80 with 136 labels
train leaf node 81 with 271 labels
train leaf node 46 with 147 labels
train leaf node 47 with 202 labels
train leaf node 48 with 44 labels
train leaf node 49 with 180 labels
train leaf node 50 with 148 labels
train leaf node 82 with 79 labels
train leaf node 83 with 138 labels
train leaf node 66 with 52 labels
train leaf node 67 with 173 labels
train leaf node 51 with 68 labels
train leaf node 52 with 104 labels
train leaf node 53 with 286 labels
train leaf node 84 with 323 labels
train leaf node 68 with 311 labels
train leaf node 54 with 98 labels
train leaf node 55 with 195 labels
train leaf node 69 with 933 labels
train leaf node 56 with 92 labels
train leaf node 85 with 701 labels
train leaf node 57 with 118 labels
train leaf node 58 with 183 labels
train leaf node 59 with 145 labels
train leaf node 60 with 408 labels
train leaf node 61 with 136 labels
train leaf node 62 with 198 labels
train leaf node 63 with 243 labels
train leaf node 64 with 224 labels
train leaf node 65 with 55 labels
train leaf node 66 with 334 labels
train leaf node 67 with 115 labels
train leaf node 68 with 171 labels
train leaf node 69 with 148 labels
train leaf node 70 with 49 labels
train leaf node 71 with 76 labels
train leaf node 72 with 184 labels
train leaf node 73 with 461 labels
train leaf node 74 with 190 labels
train leaf node 75 with 98 labels
train leaf node 76 with 102 labels
train leaf node 77 with 36 labels
train leaf node 78 with 95 labels
train leaf node 79 with 195 labels
train leaf node 80 with 314 labels
train leaf node 81 with 354 labels
train leaf node 82 with 148 labels
train leaf node 83 with 172 labels
train leaf node 84 with 188 labels
train leaf node 85 with 44 labels
train leaf node 86 with 547 labels
train leaf node 87 with 170 labels
train leaf node 88 with 347 labels
train leaf node 89 with 141 labels
train leaf node 90 with 755 labels
train leaf node 91 with 87 labels
train leaf node 92 with 143 labels
train leaf node 93 with 628 labels
train leaf node 86 with 400 labels
train leaf node 94 with 374 labels
train leaf node 95 with 311 labels
train leaf node 87 with 56 labels
train leaf node 88 with 373 labels
train leaf node 96 with 917 labels
train leaf node 89 with 144 labels
train leaf node 90 with 502 labels
train leaf node 91 with 228 labels
train leaf node 92 with 255 labels
train leaf node 93 with 26 labels
train leaf node 94 with 376 labels
train leaf node 95 with 511 labels
train leaf node 70 with 133 labels
train leaf node 71 with 239 labels
train leaf node 72 with 223 labels
train leaf node 73 with 55 labels
train leaf node 74 with 199 labels
train leaf node 96 with 372 labels
train leaf node 75 with 84 labels
train leaf node 76 with 239 labels
train leaf node 77 with 186 labels
train leaf node 78 with 66 labels
train leaf node 79 with 268 labels
train leaf node 80 with 165 labels
tree 0 training completed
train leaf node 81 with 258 labels
train leaf node 82 with 76 labels
train leaf node 83 with 269 labels
train leaf node 84 with 247 labels
train leaf node 85 with 282 labels
train leaf node 86 with 241 labels
train leaf node 87 with 565 labels
train leaf node 88 with 194 labels
train leaf node 89 with 171 labels
train leaf node 90 with 140 labels
train leaf node 91 with 391 labels
train leaf node 92 with 307 labels
train leaf node 93 with 325 labels
train leaf node 94 with 358 labels
tree 1 training completed
train leaf node 97 with 263 labels
tree 2 training completed
tree 1 predicting started
tree 1 predicting started
tree 2 predicting started
tree 0 predicting started
predict starts...
predict starts...
predict starts...
6616 95
6616 97
predict done...
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
free tree done...
free tree score mat done...
tree 0 predicting completed
6616 98
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
start training using labels from 15469 to 20469
do matrix transpose...
ready to train ....
tree 0 training started

ree 0 training started
tree 1 training started

label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 0 training completed
tree write starts...
tree write done...
tree 1 training completed
tree write starts...
tree write done...
tree 2 training completed
tree 2 predicting started
tree 2 predicting started
tree 0 predicting started
tree 1 predicting started
predict starts...
predict starts...
predict starts...
6616 95
6616 97
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
6616 98
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
start training using labels from 20469 to 25469
do matrix transpose...
ready to train ....
tree 0 training started
tree 0 training started
tree 1 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 0 training completed
tree write starts...
tree write done...
tree 1 training completed
tree write starts...
tree write done...
tree 2 training completed
tree 1 predicting started
t predicting started
t predicting started
tree 0 predicting started
predict starts...
predict starts...
predict starts...
6616 97
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
6616 95
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
6616 98
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
start training using labels from 25469 to 30469
do matrix transpose...
ready to train ....
tree 0 training started
tree 0 training started
tree 1 training started
tree 0 training started
tree 1 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 1 training completed
tree write starts...
tree write done...
tree 2 training completed
tree write starts...
tree write done...
tree 0 training completed
tree 0 predicting started
tree 1 predicting started
tree 1 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
6616 97
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
6616 95
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
6616 98
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
Training time: 1020.43 s
tree 1 predicting startedtree  tree 1 predicting startedtree  t predicting started
2 predicting started
tree 1 predicting startedtree  t predicting started
predict starts...
predict starts...
predict starts...
6616 97
6616 95
predict done...
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
free tree done...
free tree score mat done...
tree 1 predicting completed
6616 98
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
prediction time: 60.0723 ms
model size: 218.27 mb
/home/weit/miniconda3/lib/python3.7/site-packages/sklearn/externals/joblib/externals/cloudpickle/cloudpickle.py:47: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
/home/weit/.local/lib/python3.7/site-packages/xclib-0.96-py3.7-linux-x86_64.egg/xclib/data/data_utils.py:173: UserWarning: Header mis-match from inferred shape!
  warnings.warn("Header mis-match from inferred shape!")
(14146, 30938)
(6616, 30938)
(6616, 5)
Precision@1,3,5: 84.62817412333736, 73.17110036275696, 64.00846432889963
nDCG@1,3,5: 84.62817412333736, 75.87051554707813, 68.8501428826148
PSPrecision@1,3,5: 11.4443251787237 12.954900570930306 14.259234177358564
PSnDCG@1,3,5: 11.4443251787237 12.577961269268597 13.488991761090816
===============
../sandbox/results/wiki10/model/score_mat_init_ratio_50_batch_size_5000_0
Precision@1,3,5: 82.52720677146313, 64.53546956872229, 52.13119709794438
nDCG@1,3,5: 82.52720677146313, 68.63600683508653, 58.97400343776397
===============
../sandbox/results/wiki10/model/score_mat_init_ratio_50_batch_size_5000_1
Precision@1,3,5: 49.78839177750907, 34.66344216041918, 25.598548972188635
nDCG@1,3,5: 49.78839177750907, 38.08234081612162, 30.88613558124486
===============
../sandbox/results/wiki10/model/score_mat_init_ratio_50_batch_size_5000_2
Precision@1,3,5: 42.68440145102781, 26.405683192261186, 19.271463119709793
nDCG@1,3,5: 42.68440145102781, 29.9720943431456, 24.05896780512947
===============
../sandbox/results/wiki10/model/score_mat_init_ratio_50_batch_size_5000_3
Precision@1,3,5: 49.48609431680774, 31.90749697702539, 23.703143893591296
nDCG@1,3,5: 49.48609431680774, 35.79098397951783, 29.055098452053446
======Average Precision@1: 47.31962918178154

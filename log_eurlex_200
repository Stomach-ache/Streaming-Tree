start label sorting...
matrix transpose done...
3993 15539
label sorting done...
start training using labels from 0 to 1996
do matrix transpose...
ready to train ....
tree  to t1a training started training started

tree  to t1a training started training started

tree  to t1a training started training started

tree 2 training started
node 0
node node 0
node node n
split internal node0
 started training


split internal node0
 started training


split internal node0
 started training


label 87 is singleton
gets assigned to partition 18
label 92 is singleton
gets assigned to partition 34
label 51 is singleton
gets assigned to partition 32
label 19 is singleton
gets assigned to partition 59
time spent on kmeans: 2.80568 secs
label 1 is singleton
gets assigned to partition 15
time spent on kmeans: 2.80899 secs
label 57 is singleton
gets assigned to partition 99
time spent on kmeans: 2.87316 secs
n_effective_partitions=93
train leaf node 1 with 3 labels
train leaf node 2 with 2 labels
train leaf node 3 with 2 labels
train leaf node 4 with 5 labels
train leaf node 5 with 4 labels
train leaf node 6 with 8 labels
train leaf node 7 with 9 labels
train leaf node 8 with 4 labels
train leaf node 9 with 6 labels
train leaf node 10 with 11 labels
train leaf node 11 with 5 labels
train leaf node 12 with 9 labels
train leaf node 13 with 24 labels
train leaf node 14 with 17 labels
train leaf node 15 with 10 labels
train leaf node 16 with 7 labels
train leaf node 17 with 3 labels
train leaf node 18 with 10 labels
train leaf node 19 with 19 labels
train leaf node 20 with 35 labels
train leaf node 21 with 4 labels
train leaf node 22 with 16 labels
train leaf node 23 with 7 labels
train leaf node 24 with 17 labels
train leaf node 25 with 14 labels
train leaf node 26 with 4 labels
train leaf node 27 with 25 labels
train leaf node 28 with 26 labels
train leaf node 29 with 16 labels
train leaf node 30 with 22 labels
train leaf node 31 with 12 labels
train leaf node 32 with 17 labels
train leaf node 33 with 11 labels
train leaf node 34 with 22 labels
train leaf node 35 with 10 labels
train leaf node 36 with 6 labels
train leaf node 37 with 25 labels
train leaf node 38 with 32 labels
train leaf node 39 with 18 labels
train leaf node 40 with 64 labels
train leaf node 41 with 9 labels
train leaf node 42 with 26 labels
train leaf node 43 with 10 labels
train leaf node 44 with 26 labels
train leaf node 45 with 18 labels
train leaf node 46 with 16 labels
train leaf node 47 with 20 labels
train leaf node 48 with 4 labels
train leaf node 49 with 33 labels
train leaf node 50 with 20 labels
train leaf node 51 with 27 labels
train leaf node 52 with 20 labels
train leaf node 53 with 23 labels
train leaf node 54 with 44 labels
train leaf node 55 with 16 labels
train leaf node 56 with 17 labels
train leaf node 57 with 22 labels
train leaf node 58 with 33 labels
train leaf node 59 with 2 labels
train leaf node 60 with 43 labels
train leaf node 61 with 20 labels
train leaf node 62 with 21 labels
train leaf node 63 with 68 labels
train leaf node 64 with 9 labels
train leaf node 65 with 49 labels
n_effective_partitions=91
train leaf node 1 with 2 labels
train leaf node 2 with 4 labels
train leaf node 3 with 2 labels
train leaf node 4 with 3 labels
train leaf node 5 with 3 labels
train leaf node 6 with 10 labels
train leaf node 7 with 8 labels
train leaf node 8 with 6 labels
train leaf node 9 with 9 labels
train leaf node 10 with 11 labels
train leaf node 11 with 7 labels
train leaf node 12 with 3 labels
train leaf node 13 with 12 labels
train leaf node 14 with 3 labels
train leaf node 15 with 4 labels
train leaf node 16 with 6 labels
train leaf node 17 with 7 labels
train leaf node 18 with 4 labels
train leaf node 19 with 5 labels
train leaf node 20 with 21 labels
train leaf node 66 with 20 labels
train leaf node 67 with 35 labels
train leaf node 21 with 38 labels
train leaf node 22 with 7 labels
train leaf node 23 with 15 labels
train leaf node 24 with 20 labels
n_effective_partitions=92
train leaf node 1 with 2 labels
train leaf node 2 with 2 labels
train leaf node 3 with 3 labels
train leaf node 4 with 3 labels
train leaf node 5 with 5 labels
train leaf node 6 with 5 labels
train leaf node 7 with 5 labels
train leaf node 8 with 6 labels
train leaf node 9 with 9 labels
train leaf node 10 with 2 labels
train leaf node 11 with 11 labels
train leaf node 12 with 13 labels
train leaf node 13 with 11 labels
train leaf node 14 with 15 labels
train leaf node 25 with 3 labels
train leaf node 26 with 20 labels
train leaf node 15 with 10 labels
train leaf node 68 with 57 labels
train leaf node 16 with 32 labels
train leaf node 17 with 19 labels
train leaf node 18 with 6 labels
train leaf node 19 with 7 labels
train leaf node 20 with 11 labels
train leaf node 21 with 9 labels
train leaf node 27 with 63 labels
train leaf node 22 with 38 labels
train leaf node 23 with 11 labels
train leaf node 24 with 7 labels
train leaf node 25 with 15 labels
train leaf node 26 with 18 labels
train leaf node 27 with 6 labels
train leaf node 28 with 9 labels
train leaf node 29 with 10 labels
train leaf node 30 with 18 labels
train leaf node 31 with 15 labels
train leaf node 32 with 9 labels
train leaf node 33 with 7 labels
train leaf node 34 with 28 labels
train leaf node 69 with 4 labels
train leaf node 70 with 22 labels
train leaf node 35 with 18 labels
train leaf node 36 with 9 labels
train leaf node 71 with 37 labels
train leaf node 37 with 15 labels
train leaf node 38 with 26 labels
train leaf node 39 with 51 labels
train leaf node 28 with 15 labels
train leaf node 29 with 11 labels
train leaf node 30 with 20 labels
train leaf node 31 with 27 labels
train leaf node 32 with 17 labels
train leaf node 72 with 29 labels
train leaf node 33 with 4 labels
train leaf node 34 with 7 labels
train leaf node 35 with 6 labels
train leaf node 36 with 7 labels
train leaf node 37 with 9 labels
train leaf node 38 with 29 labels
train leaf node 39 with 15 labels
train leaf node 40 with 16 labels
train leaf node 73 with 4 labels
train leaf node 74 with 47 labels
train leaf node 41 with 42 labels
train leaf node 40 with 31 labels
train leaf node 75 with 37 labels
train leaf node 42 with 3 labels
train leaf node 43 with 35 labels
train leaf node 41 with 2 labels
train leaf node 42 with 28 labels
train leaf node 76 with 18 labels
train leaf node 43 with 18 labels
train leaf node 44 with 6 labels
train leaf node 45 with 9 labels
train leaf node 77 with 25 labels
train leaf node 46 with 22 labels
train leaf node 47 with 21 labels
train leaf node 48 with 7 labels
train leaf node 49 with 25 labels
train leaf node 78 with 29 labels
train leaf node 44 with 7 labels
train leaf node 45 with 8 labels
train leaf node 46 with 40 labels
train leaf node 50 with 13 labels
train leaf node 51 with 26 labels
train leaf node 52 with 9 labels
train leaf node 53 with 20 labels
train leaf node 79 with 16 labels
train leaf node 54 with 7 labels
train leaf node 55 with 16 labels
train leaf node 80 with 23 labels
train leaf node 47 with 36 labels
train leaf node 56 with 7 labels
train leaf node 57 with 15 labels
train leaf node 58 with 33 labels
train leaf node 59 with 6 labels
train leaf node 60 with 19 labels
train leaf node 81 with 47 labels
train leaf node 61 with 16 labels
train leaf node 62 with 90 labels
train leaf node 48 with 28 labels
train leaf node 82 with 9 labels
train leaf node 83 with 27 labels
train leaf node 49 with 23 labels
train leaf node 50 with 16 labels
train leaf node 51 with 14 labels
train leaf node 84 with 51 labels
train leaf node 52 with 9 labels
train leaf node 53 with 16 labels
train leaf node 54 with 33 labels
train leaf node 55 with 37 labels
train leaf node 56 with 52 labels
train leaf node 85 with 12 labels
train leaf node 86 with 54 labels
train leaf node 57 with 8 labels
train leaf node 58 with 15 labels
train leaf node 59 with 23 labels
train leaf node 60 with 43 labels
train leaf node 63 with 4 labels
train leaf node 61 with 33 labels
train leaf node 64 with 20 labels
train leaf node 65 with 26 labels
train leaf node 66 with 20 labels
train leaf node 62 with 23 labels
train leaf node 67 with 32 labels
train leaf node 68 with 47 labels
train leaf node 63 with 21 labels
train leaf node 64 with 37 labels
train leaf node 65 with 70 labels
train leaf node 69 with 19 labels
train leaf node 70 with 66 labels
train leaf node 87 with 13 labels
train leaf node 88 with 32 labels
train leaf node 89 with 6 labels
train leaf node 90 with 12 labels
train leaf node 91 with 112 labels
train leaf node 66 with 20 labels
train leaf node 92 with 10 labels
train leaf node 93 with 51 labels
train leaf node 67 with 27 labels
train leaf node 68 with 40 labels
train leaf node 69 with 19 labels
train leaf node 70 with 47 labels
train leaf node 71 with 18 labels
train leaf node 72 with 45 labels
train leaf node 73 with 66 labels
train leaf node 71 with 10 labels
train leaf node 72 with 7 labels
train leaf node 73 with 13 labels
tree 1 training completed
train leaf node 74 with 8 labels
train leaf node 75 with 44 labels
train leaf node 76 with 23 labels
train leaf node 77 with 19 labels
train leaf node 78 with 67 labels
train leaf node 74 with 22 labels
train leaf node 75 with 20 labels
train leaf node 76 with 23 labels
train leaf node 77 with 38 labels
train leaf node 79 with 15 labels
train leaf node 78 with 19 labels
train leaf node 80 with 36 labels
train leaf node 79 with 11 labels
train leaf node 80 with 11 labels
train leaf node 81 with 44 labels
train leaf node 81 with 24 labels
train leaf node 82 with 45 labels
train leaf node 82 with 29 labels
train leaf node 83 with 57 labels
train leaf node 83 with 9 labels
train leaf node 84 with 27 labels
train leaf node 85 with 63 labels
train leaf node 84 with 65 labels
train leaf node 86 with 42 labels
train leaf node 87 with 32 labels
train leaf node 85 with 52 labels
train leaf node 88 with 21 labels
train leaf node 89 with 107 labels
train leaf node 90 with 32 labels
train leaf node 91 with 64 labels
train leaf node 86 with 9 labels
train leaf node 87 with 45 labels
train leaf node 88 with 24 labels
train leaf node 89 with 19 labels
train leaf node 90 with 107 labels
train leaf node 91 with 8 labels
train leaf node 92 with 72 labels
tree 2 training completed
tree 0 training completed
tree 0 predicting started
tree 1 predicting started
tree 1 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
3809 92
predict done...
3809 93
free tree done...
free tree score mat done...
tree 1 predicting completed
predict done...
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
free tree done...
free tree score mat done...
tree 0 predicting completed
start training using labels from 1996 to 2196
do matrix transpose...
ready to train ....
tree 0 training started
tree 2 training started
tree 1 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write starts...
tree write starts...
tree write done...
tree 1 training completed
tree write done...
tree 2 training completed
tree write done...
tree 0 training completed
tree 0 predicting started
tree 1 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 92
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
3809 93
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
start training using labels from 2196 to 2396
do matrix transpose...
ready to train ....
tree 0 training started
tree 1 training started
tree 1 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 0 training completed
tree write starts...
tree write starts...
tree write done...
tree 2 training completed
tree write done...
tree 1 training completed
tree 0 predicting started
tree 1 predicting started
tree 1 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 92
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
3809 93
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
start training using labels from 2396 to 2596
do matrix transpose...
ready to train ....
tree 0 training started
2 training started
rted
tree 1 training started
2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write starts...
tree write done...
tree 0 training completed
tree write done...
tree 1 training completed
tree write starts...
tree write done...
tree 2 training completed
tree 0 predicting started
tree 1 predicting started
tree 1 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 92
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
3809 93
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
start training using labels from 2596 to 2796
do matrix transpose...
ready to train ....
tree 0 training started
tree 0 training started
tree 2 training started
tree 0 training started
tree 2 training started
tree 1 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 2 training completed
tree write starts...
tree write starts...
tree write done...
tree 1 training completed
tree write done...
tree 0 training completed
tree 0 predicting started
tree 1 predicting started
tree tree 1 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 92
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
3809 93
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
start training using labels from 2796 to 2996
do matrix transpose...
ready to train ....
tree 0 training started
1 training started
2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 0 training completed
tree write starts...
tree write starts...
tree write done...
tree 2 training completed
tree write done...
tree 1 training completed
tree 0 predicting started
tree 1 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 92
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
3809 93
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
start training using labels from 2996 to 3196
do matrix transpose...
ready to train ....
tree 0 training started
tree 0 training started
tree 1 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 0 training completed
tree write starts...
tree write starts...
tree write done...
tree 1 training completed
tree write done...
tree 2 training completed
tree 1 predicting started
tree 1 predicting started
2 predicting started
tree tree 1 predicting started
2 predicting started
tree 0 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 92
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
3809 93
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
start training using labels from 3196 to 3396
do matrix transpose...
ready to train ....
tree 0 training started
tree 0 training started
tree 1 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 2 training completed
tree write starts...
tree write starts...
tree write done...
tree 0 training completed
tree write done...
tree 1 training completed
tree 0 predicting started
tree 1 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 92
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
3809 93
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
start training using labels from 3396 to 3596
do matrix transpose...
ready to train ....
tree 0 training started
tree 0 training started
tree 1 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 2 training completed
tree write starts...
tree write starts...
tree write done...
tree 0 training completed
tree write done...
tree 1 training completed
tree 0 predicting started
tree 1 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 92
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
3809 93
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
start training using labels from 3596 to 3796
do matrix transpose...
ready to train ....
tree 0 training started
tree 0 training started
tree 1 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 0 training completed
tree write starts...
tree write starts...
tree write done...
tree 2 training completed
tree write done...
tree 1 training completed
tree 1 tra1 predicting started
0 predicting startedtree 1 tra1 predicting started
0 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 92
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
3809 93
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
start training using labels from 3796 to 3993
do matrix transpose...
ready to train ....
tree 0 training started
tree 0 training started
tree 1 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 0 training completed
tree write starts...
tree write starts...
tree write done...
tree 1 training completed
tree write done...
tree 2 training completed
tree 2 predicting started
tree 0 predicting started
tree 1 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 92
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
3809 93
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
Training time: 28.292 s
tree tree 0  predicting started                   
 tree tree 0  predicting started                   
 tree tree 0  predicting started                   
 tree 1 predicting started
predict starts...
predict starts...
predict starts...
3809 94
3809 92
3809 93
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
predict done...
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
free tree done...
free tree score mat done...
tree 0 predicting completed
prediction time: 2.80489 ms
model size: 27.5145 mb
/home/weit/miniconda3/lib/python3.7/site-packages/sklearn/externals/joblib/externals/cloudpickle/cloudpickle.py:47: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
/home/weit/.local/lib/python3.7/site-packages/xclib-0.96-py3.7-linux-x86_64.egg/xclib/data/data_utils.py:173: UserWarning: Header mis-match from inferred shape!
  warnings.warn("Header mis-match from inferred shape!")
(15539, 3993)
(3809, 3993)
(3809, 5)
Precision@1,3,5: 81.20241533210817, 67.18298766080336, 55.22184300341297
nDCG@1,3,5: 81.20241533210817, 70.79320842655802, 64.48845700579292
PSPrecision@1,3,5: 35.53724435212192 42.49075498444985 45.540130049281494
PSnDCG@1,3,5: 35.53724435212192 40.58895640775887 42.676338336087966
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_200_0
Precision@1,3,5: 68.31189288527173, 49.46180099763717, 36.072459963244945
nDCG@1,3,5: 68.31189288527173, 54.02156386144761, 45.396020500156915
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_200_1
Precision@1,3,5: 18.92885271724862, 8.121116653539861, 5.087949593069047
nDCG@1,3,5: 18.92885271724862, 10.436883336335487, 7.894973703100211
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_200_2
Precision@1,3,5: 12.706747177736938, 5.250721974271463, 3.292202677868207
nDCG@1,3,5: 12.706747177736938, 6.850300468078347, 5.276938733009332
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_200_3
Precision@1,3,5: 18.902599107377263, 7.648551675855431, 4.830664216329746
nDCG@1,3,5: 18.902599107377263, 10.04032000102376, 7.754950430681698
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_200_4
Precision@1,3,5: 16.48726699921239, 6.5371488579679715, 4.111315305854555
nDCG@1,3,5: 16.48726699921239, 8.629678651399733, 6.604321984001471
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_200_5
Precision@1,3,5: 17.353636124967185, 7.193489104751903, 4.5156208978734576
nDCG@1,3,5: 17.353636124967185, 9.384305868497739, 7.257316704576206
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_200_6
Precision@1,3,5: 17.30112890522447, 7.00096263236195, 4.363349960619585
nDCG@1,3,5: 17.30112890522447, 9.180908520854102, 6.926475175490782
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_200_7
Precision@1,3,5: 17.038592806510895, 6.694670517196115, 4.221580467314256
nDCG@1,3,5: 17.038592806510895, 8.886588729226789, 6.841710181192265
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_200_8
Precision@1,3,5: 19.506432134418482, 7.823575741664479, 4.940929377789446
nDCG@1,3,5: 19.506432134418482, 10.284235450907744, 7.863771260511089
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_200_9
Precision@1,3,5: 19.873982672617487, 8.164872669992123, 5.150958256760305
nDCG@1,3,5: 19.873982672617487, 10.67877032515992, 8.283733820679736
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_200_10
Precision@1,3,5: 14.83328957731688, 6.055832676993086, 3.964295090574954
nDCG@1,3,5: 14.83328957731688, 7.906391266458562, 6.1510232812347345
======Average Precision@1: 17.293252822263064

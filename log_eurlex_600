start label sorting...
matrix transpose done...
3993 15539
label sorting done...
start training using labels from 0 to 1996
do matrix transpose...
ready to train ....
tree 0 training started
tree 0 training started
tree 1 training started
node 0
node 0
node 0
node 0
split internal noderted
tree 1 trainin

split internal noderted
tree 1 trainin

split internal noderted
tree 1 trainin

label 73 is singleton
gets assigned to partition 48
label 88 is singleton
gets assigned to partition 47
label 51 is singleton
gets assigned to partition 70
label 64 is singleton
gets assigned to partition 12
time spent on kmeans: 2.54785 secs
label 93 is singleton
gets assigned to partition 81
time spent on kmeans: 2.75884 secs
label 88 is singleton
gets assigned to partition 77
label 13 is singleton
gets assigned to partition 58
time spent on kmeans: 3.26344 secs
n_effective_partitions=93
train leaf node 1 with 2 labels
train leaf node 2 with 2 labels
train leaf node 3 with 3 labels
train leaf node 4 with 5 labels
train leaf node 5 with 7 labels
train leaf node 6 with 3 labels
train leaf node 7 with 9 labels
train leaf node 8 with 10 labels
train leaf node 9 with 13 labels
train leaf node 10 with 4 labels
train leaf node 11 with 4 labels
train leaf node 12 with 9 labels
train leaf node 13 with 5 labels
train leaf node 14 with 16 labels
train leaf node 15 with 3 labels
train leaf node 16 with 19 labels
train leaf node 17 with 9 labels
train leaf node 18 with 15 labels
train leaf node 19 with 5 labels
train leaf node 20 with 8 labels
train leaf node 21 with 19 labels
train leaf node 22 with 20 labels
train leaf node 23 with 22 labels
n_effective_partitions=91
train leaf node 1 with 2 labels
train leaf node 2 with 2 labels
train leaf node 3 with 5 labels
train leaf node 4 with 5 labels
train leaf node 5 with 7 labels
train leaf node 6 with 5 labels
train leaf node 7 with 20 labels
train leaf node 24 with 10 labels
train leaf node 25 with 11 labels
train leaf node 26 with 18 labels
train leaf node 27 with 19 labels
train leaf node 28 with 38 labels
train leaf node 8 with 13 labels
train leaf node 9 with 13 labels
train leaf node 10 with 18 labels
train leaf node 11 with 5 labels
train leaf node 12 with 14 labels
train leaf node 13 with 22 labels
train leaf node 29 with 12 labels
train leaf node 14 with 4 labels
train leaf node 30 with 8 labels
train leaf node 15 with 22 labels
train leaf node 31 with 33 labels
train leaf node 16 with 40 labels
train leaf node 32 with 8 labels
train leaf node 33 with 14 labels
train leaf node 17 with 6 labels
train leaf node 18 with 13 labels
train leaf node 19 with 20 labels
train leaf node 34 with 9 labels
train leaf node 35 with 19 labels
train leaf node 20 with 24 labels
train leaf node 36 with 27 labels
train leaf node 37 with 21 labels
train leaf node 21 with 4 labels
train leaf node 22 with 6 labels
train leaf node 23 with 10 labels
train leaf node 24 with 18 labels
train leaf node 38 with 12 labels
train leaf node 25 with 36 labels
train leaf node 39 with 11 labels
train leaf node 40 with 23 labels
train leaf node 26 with 11 labels
train leaf node 27 with 12 labels
train leaf node 28 with 18 labels
train leaf node 41 with 17 labels
train leaf node 29 with 5 labels
train leaf node 30 with 6 labels
train leaf node 31 with 22 labels
train leaf node 32 with 11 labels
train leaf node 33 with 37 labels
train leaf node 42 with 2 labels
train leaf node 43 with 12 labels
train leaf node 44 with 22 labels
train leaf node 45 with 31 labels
train leaf node 46 with 6 labels
train leaf node 47 with 15 labels
train leaf node 48 with 20 labels
train leaf node 49 with 7 labels
train leaf node 50 with 31 labels
train leaf node 34 with 8 labels
train leaf node 35 with 22 labels
n_effective_partitions=93
train leaf node 1 with 2 labels
train leaf node 2 with 2 labels
train leaf node 3 with 2 labels
train leaf node 4 with 6 labels
train leaf node 36 with 13 labels
train leaf node 5 with 3 labels
train leaf node 6 with 6 labels
train leaf node 7 with 14 labels
train leaf node 8 with 5 labels
train leaf node 9 with 7 labels
train leaf node 10 with 4 labels
train leaf node 11 with 7 labels
train leaf node 12 with 13 labels
train leaf node 37 with 49 labels
train leaf node 51 with 8 labels
train leaf node 13 with 9 labels
train leaf node 14 with 11 labels
train leaf node 52 with 55 labels
train leaf node 15 with 16 labels
train leaf node 16 with 2 labels
train leaf node 17 with 7 labels
train leaf node 18 with 6 labels
train leaf node 19 with 8 labels
train leaf node 20 with 9 labels
train leaf node 21 with 12 labels
train leaf node 22 with 6 labels
train leaf node 23 with 11 labels
train leaf node 24 with 5 labels
train leaf node 25 with 14 labels
train leaf node 26 with 40 labels
train leaf node 27 with 5 labels
train leaf node 28 with 18 labels
train leaf node 29 with 16 labels
train leaf node 30 with 26 labels
train leaf node 31 with 2 labels
train leaf node 32 with 17 labels
train leaf node 33 with 10 labels
train leaf node 34 with 4 labels
train leaf node 35 with 24 labels
train leaf node 36 with 19 labels
train leaf node 37 with 10 labels
train leaf node 38 with 29 labels
train leaf node 38 with 10 labels
train leaf node 53 with 29 labels
train leaf node 39 with 3 labels
train leaf node 40 with 7 labels
train leaf node 41 with 18 labels
train leaf node 39 with 17 labels
train leaf node 42 with 4 labels
train leaf node 43 with 40 labels
train leaf node 40 with 14 labels
train leaf node 41 with 17 labels
train leaf node 42 with 14 labels
train leaf node 43 with 13 labels
train leaf node 54 with 19 labels
train leaf node 55 with 14 labels
train leaf node 56 with 33 labels
train leaf node 44 with 11 labels
train leaf node 45 with 24 labels
train leaf node 44 with 13 labels
train leaf node 57 with 50 labels
train leaf node 45 with 32 labels
train leaf node 46 with 23 labels
train leaf node 47 with 35 labels
train leaf node 46 with 25 labels
train leaf node 48 with 7 labels
train leaf node 47 with 25 labels
train leaf node 49 with 29 labels
train leaf node 50 with 6 labels
train leaf node 51 with 11 labels
train leaf node 52 with 11 labels
train leaf node 48 with 43 labels
train leaf node 53 with 20 labels
train leaf node 54 with 49 labels
train leaf node 58 with 7 labels
train leaf node 59 with 21 labels
train leaf node 60 with 13 labels
train leaf node 55 with 11 labels
train leaf node 61 with 6 labels
train leaf node 56 with 10 labels
train leaf node 62 with 15 labels
train leaf node 57 with 14 labels
train leaf node 58 with 16 labels
train leaf node 63 with 42 labels
train leaf node 59 with 38 labels
train leaf node 60 with 100 labels
train leaf node 64 with 15 labels
train leaf node 65 with 26 labels
train leaf node 49 with 8 labels
train leaf node 66 with 40 labels
train leaf node 50 with 33 labels
train leaf node 51 with 24 labels
train leaf node 52 with 35 labels
train leaf node 53 with 4 labels
train leaf node 54 with 28 labels
train leaf node 67 with 26 labels
train leaf node 55 with 6 labels
train leaf node 56 with 9 labels
train leaf node 57 with 21 labels
train leaf node 68 with 30 labels
train leaf node 58 with 12 labels
train leaf node 59 with 21 labels
train leaf node 60 with 24 labels
train leaf node 69 with 19 labels
train leaf node 70 with 73 labels
train leaf node 61 with 45 labels
train leaf node 62 with 16 labels
train leaf node 63 with 51 labels
train leaf node 64 with 85 labels
train leaf node 71 with 21 labels
train leaf node 72 with 61 labels
train leaf node 61 with 28 labels
train leaf node 62 with 20 labels
train leaf node 63 with 8 labels
train leaf node 64 with 35 labels
train leaf node 73 with 38 labels
train leaf node 65 with 12 labels
train leaf node 66 with 22 labels
train leaf node 65 with 5 labels
train leaf node 66 with 4 labels
train leaf node 67 with 32 labels
train leaf node 67 with 17 labels
train leaf node 68 with 20 labels
train leaf node 68 with 27 labels
train leaf node 69 with 14 labels
train leaf node 70 with 62 labels
train leaf node 74 with 7 labels
train leaf node 75 with 37 labels
train leaf node 69 with 41 labels
train leaf node 76 with 31 labels
train leaf node 77 with 11 labels
train leaf node 78 with 27 labels
train leaf node 70 with 19 labels
train leaf node 71 with 31 labels
train leaf node 72 with 18 labels
train leaf node 73 with 35 labels
train leaf node 79 with 16 labels
train leaf node 80 with 50 labels
train leaf node 74 with 41 labels
train leaf node 71 with 31 labels
train leaf node 81 with 25 labels
train leaf node 75 with 12 labels
train leaf node 76 with 36 labels
train leaf node 82 with 9 labels
train leaf node 83 with 17 labels
train leaf node 84 with 45 labels
train leaf node 72 with 24 labels
train leaf node 73 with 36 labels
train leaf node 85 with 43 labels
train leaf node 77 with 42 labels
train leaf node 74 with 24 labels
train leaf node 75 with 22 labels
train leaf node 86 with 28 labels
train leaf node 78 with 30 labels
train leaf node 79 with 22 labels
train leaf node 87 with 37 labels
train leaf node 76 with 2 labels
train leaf node 77 with 9 labels
train leaf node 78 with 16 labels
train leaf node 79 with 18 labels
train leaf node 80 with 14 labels
train leaf node 80 with 23 labels
train leaf node 81 with 47 labels
train leaf node 81 with 15 labels
train leaf node 88 with 23 labels
train leaf node 82 with 53 labels
train leaf node 89 with 46 labels
train leaf node 82 with 38 labels
train leaf node 83 with 45 labels
train leaf node 84 with 38 labels
train leaf node 83 with 12 labels
train leaf node 84 with 10 labels
train leaf node 85 with 36 labels
train leaf node 85 with 40 labels
train leaf node 90 with 8 labels
train leaf node 91 with 106 labels
train leaf node 92 with 34 labels
train leaf node 86 with 33 labels
train leaf node 86 with 30 labels
train leaf node 93 with 67 labels
train leaf node 87 with 12 labels
train leaf node 88 with 33 labels
train leaf node 89 with 151 labels
train leaf node 87 with 14 labels
train leaf node 88 with 24 labels
train leaf node 89 with 65 labels
train leaf node 90 with 81 labels
train leaf node 91 with 64 labels
tree 1 training completed
train leaf node 90 with 15 labels
train leaf node 91 with 117 labels
train leaf node 92 with 11 labels
train leaf node 93 with 69 labels
tree 2 training completed
tree 0 training completed
tree 0 predicting started
tree 1 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
3809 94
3809 92
predict done...
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
free tree done...
free tree score mat done...
tree 2 predicting completed
start training using labels from 1996 to 2596
do matrix transpose...
ready to train ....
tree 0 training started
 training started
 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 1 training completed
tree write starts...
tree write done...
tree 2 training completed
tree write starts...
tree write done...
tree 0 training completed
tree 0 predicting started
tree 1 predicting started
tree 1 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
3809 92
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
predict done...
predict done...
free tree done...
free tree score mat done...
tree 2 predicting completed
free tree done...
free tree score mat done...
tree 0 predicting completed
start training using labels from 2596 to 3196
do matrix transpose...
ready to train ....
tree 0 training started
tree 0 training started
tree 1 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write done...
tree 1 training completed
tree write starts...
tree write starts...
tree write done...
tree 2 training completed
tree write done...
tree 0 training completed
tree 1 predicting started
tree 0 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 94
3809 92
predict done...
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
free tree done...
free tree score mat done...
tree 2 predicting completed
start training using labels from 3196 to 3796
do matrix transpose...
ready to train ....
tree 1 training started
tree 2 training started
0 training started
tree 2 training started
label insertion done...
label insertion done...
label insertion done...
tree write starts...
tree write starts...
tree write done...
tree 1 training completed
tree write starts...
tree write done...
tree 2 training completed
tree write done...
tree 0 training completed
tree 1 predicting started
tree 0 predicting started
tree 2 predicting started
predict starts...
predict starts...
predict starts...
3809 94
predict done...
free tree done...
free tree score mat done...
tree 1 predicting completed
3809 94
3809 92
predict done...
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
free tree done...
free tree score mat done...
tree 2 predicting completed
Training time: 34.4173 s
tree tree tree 0 predicting started
tree tree tree 0 predicting started
2 predicting started1 predicting started 
tree tree tree 0 predicting started
2 predicting started1 predicting started 
predict starts...
predict starts...
predict starts...
3809 94
3809 94
predict done...
3809 92
free tree done...
free tree score mat done...
tree 1 predicting completed
predict done...
predict done...
free tree done...
free tree score mat done...
tree 0 predicting completed
free tree done...
free tree score mat done...
tree 2 predicting completed
prediction time: 2.60358 ms
model size: 26.7456 mb
/home/weit/miniconda3/lib/python3.7/site-packages/sklearn/externals/joblib/externals/cloudpickle/cloudpickle.py:47: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
/home/weit/.local/lib/python3.7/site-packages/xclib-0.96-py3.7-linux-x86_64.egg/xclib/data/data_utils.py:173: UserWarning: Header mis-match from inferred shape!
  warnings.warn("Header mis-match from inferred shape!")
(15539, 3993)
(3809, 3993)
(3809, 5)
Precision@1,3,5: 80.46731425571016, 66.29911612846766, 53.98792333945918
nDCG@1,3,5: 80.46731425571016, 69.92808702639583, 63.32503100047033
PSPrecision@1,3,5: 35.55210043643635 42.256549249024786 44.939135668107355
PSnDCG@1,3,5: 35.55210043643635 40.43728062470969 42.30981991551315
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_600_0
Precision@1,3,5: 68.5744289839853, 49.89060995886934, 36.23523234444736
nDCG@1,3,5: 68.5744289839853, 54.36609265633283, 45.579055048128545
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_600_1
Precision@1,3,5: 38.330270412181676, 19.611446573903912, 12.491467576791809
nDCG@1,3,5: 38.330270412181676, 23.742367506483507, 18.342286791207947
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_600_2
Precision@1,3,5: 38.225255972696246, 19.803973046293866, 12.53347335258598
nDCG@1,3,5: 38.225255972696246, 23.90756677702645, 18.421560627463055
===============
../sandbox/results/eurlex/model/score_mat_init_ratio_50_batch_size_600_3
Precision@1,3,5: 43.94854292465214, 21.589218517546165, 13.651877133105803
nDCG@1,3,5: 43.94854292465214, 26.56769195649389, 20.539472445239106
======Average Precision@1: 40.16802310317669
